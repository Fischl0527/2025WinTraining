## 个人信息
个人名称：Monday

个人排名：450

![](https://cdn.nlark.com/yuque/0/2025/png/42554774/1737335840964-32b3de49-6c33-4173-8d90-ac2b66fec11a.png)

## 解题情况
|  类型  |  题目名称  |  分数  |
| --- | --- | --- |
| Crypto | 通往哈希的旅程 | 16 |
| Crypto | 你是小哈斯？ | 25 |
| Crypto | funny_rsa | 54 |
| Misc | 问卷 | 28 |




## 解题过程
### 1.通往哈希的旅程
给了一串字符串，在线网站判断后知道是sha1

![](https://cdn.nlark.com/yuque/0/2025/png/42554774/1737097038300-b7730870-c9fd-46b7-bb2f-c75340ecddc6.png)

因为说了是11位数字，加上前三位是188已经给出，那么我们可以写个脚本爆破一下

```python
import hashlib

def sha1_encrypt(input_string):
    sha1 = hashlib.sha1()
    sha1.update(input_string.encode('utf-8'))
    return sha1.hexdigest()


a = 'ca12fd8250972ec363a16593356abb1f3cf3a16d'
for i in range(18870000000,18900000000):

    if sha1_encrypt(str(i))==a:
        print(i)

# 18876011645
```

爆破范围可以调一调，时间会短一点（应该有更好方法，还没复现）

#### flag值：
flag{18876011645}



### 2.你是小哈斯？
给了一个txt文件，一堆字符串，根据提示应该是哈希，同样的用上面那个网站后发现全部是sha1，同样写个脚本爆破一下，把每个字符都打出来，里面就可以找到flag，这个爆破很快

思路就是把文档里的值和可打印字符的sha1值作比较，一样的就打印出来

```python
import string
import hashlib

def sha1_encrypt(input_string):
    sha1 = hashlib.sha1()
    sha1.update(input_string.encode('utf-8'))
    return sha1.hexdigest()

a1=string.printable[:-1]

with open('题目内容.txt', 'r') as file:
    line = file.readline()
    while line:
        for i in a1:
            if sha1_encrypt(i) == str(line.strip()):
                print(i,end='')  # 去除每行结尾的换行符
        line = file.readline()
        
# 1234567890-=qwertyuiopflag{no_is_flag}asdfghjklzxcvbnm,flag{game_cqb_isis_cxyz}.asdfghjklzxcvbnm,.qwertyuiopflag{no_is_flag}1234567890-=

```

#### flag值：
flag{game_cqb_isis_cxyz}



### 3.funny_rsa
重点放在下面这几个值

```python
# funny 1
print(p+q - p*q + random.randint(-1025, +1025))
# funny 2
print(bytes_to_long(m)*bytes_to_long(hint))
# funny 3
print(bytes_to_long(m)*n*bytes_to_long(hint) - 1025)
# funny 4
print(pow(bytes_to_long(hint), 65537, n))
```

我们funny 1为f1，依此下去记这四个数字，记随机数random.randint(-1025, +1025))为r1，则四个式子可以表示为

![image](https://cdn.nlark.com/yuque/__latex/8ffce261549fc33f740fc0582e2bf131.svg)

![image](https://cdn.nlark.com/yuque/__latex/50d81cab1a40062aaa4ae9cd9e02eefa.svg)

![image](https://cdn.nlark.com/yuque/__latex/b179fb733d234aee0b08639b18c1df2a.svg)

![image](https://cdn.nlark.com/yuque/__latex/4d64b0474c1017be50e0a79abb4ddf19.svg)

f2和f3联立可以得出n，对于phi(n)=(p-1)(q-1)=n-(p+q)+1=-f1+r+1

r的范围给了，只要遍历一下就可以得出phi(n)，得出来后解一下f4就可以得到hint，有了hint结合f2就可以得到m，这个m是一个fake flag，只要把得到的fake flag里的数字在转一下字节就可以得到真flag了，代码如下

```python
f1 = -17696257697673533517695215344482784803953262308315416688683426036407670627060768442028628137969719289734388098357659521255966031131390425549974547376165392147394271974280020234101031837837842620775164967619688351222631803585213762205793801828461058523503457022704948803795360591719481537859524689187847958423587638744086265395438163720708785636319741908901866136858161996560525252461619641697255819255661269266471689541673348377717503957328827459396677344554172542244540931545166846117626585580964318010181586516365891413041095399344533013057011854734701706641516027767197631044458866554524544179750101814734153116374

f2 = 23686728880494758233026798487859622755203105120130180108222733038275788082047755828771429849079142070779731875136837978862880500205129022165600511611807590195341629179443057553694284913974985006590617143873019530710952420242412437467917519539591683898715990297750494900923245055632544763410401540518654522017115269508183482044872091052235608170710105631742176900306097734799793264202179181242015892763311753674799273300604804820015447161950996038795518844564861004398396796284113803759208011
f3 = 419166458284161364374927086939132546372091965414091344286510440034452974193054721041229068769658972346759176374539266235862042787888391905466876330331208651698002159575012622762558316612596034044109738533275009086940744966244759977014078484433213617582101347769476703012517531619023366639507114909172774156647998737369356116119513795863130218094614475699956104117183821832339358478426978211282822163928764161915824622224165694904342224081321345691796882691318330781141960650263488927837990954860719950761728580780956673732592771855694502630374907978111094148614378212006604233062606116168868545120407836000858982789824582335703891535021579560434875457656655941164757860852341484554015214879991896412137447010444797452119431147303295803678311972500421396900616845556636124424993090559354406417222700637726789045926994792374756038517484548544506630672251868349748176389591615802039026216656891403871728516658502023897343287181822303758976641229952646993446276281728919020747050486979968215989594984778920359425264076558022228448529089047021814759587052098774273578311709416672952218680244714492318709603579024

f4 = 13541898381047120826573743874105965191304100799517820464813250201030319771155430755606644860103469823030581858410957600027665504533335597988508084284252510961847999525811558651340906333101248760970154440885012717108131962658921396549020943832983712611749095468180648011521808106480590665594160479324931351996812185581193608244652792936715504284312172734662364676167010674359243219959129435127950232321130725013160026977752389409620674167037650367196748592335698164875097139931376389630867192761783936757260359606379088577977154378217235326249540098268616890307702288393952949444753648206049856544634755301197410481479

n = (f3+1025)//f2

d=0
hint=0
for i in range(-1025, +1026):
    phi = (-f1-i+1)
    if gcd(phi,65537)==1:
        d= gmpy2.invert(65537,phi)
        hint = pow(f4,d,n)
        m=f2//hint
        if b'flag' in long_to_bytes(m):
            print(hint)
            print(m)
            print(long_to_bytes(hint))
            print(long_to_bytes(m))
a=5044833682931814367881036090727702841234957943094051805420875375031047763007750978962055801191968383860156687597666360268370292861
print(long_to_bytes(a))

# b'Of course, So good, and enjoy the funny number, it is true flag'
# b'fake:flag{5044833682931814367881036090727702841234957943094051805420875375031047763007750978962055801191968383860156687597666360268370292861}'
# b'true:flag{aB3-CdE7_FgH9-iJkLmNoPqRsT-UvWxYz1234567890}'
```

#### flag值：
flag{aB3-CdE7_FgH9-iJkLmNoPqRsT-UvWxYz1234567890}

